# דוח בדיקות: משימת איסוף רכב / שינוע (TaskDialog)

מסמך זה מפרט את הבדיקות שבוצעו עבור סוג המשימה **"איסוף רכב / שינוע"** ברכיב ה-`TaskDialog`.

## קובץ הבדיקה

`tests/admin/taskdialog-pickup.test.tsx`

## תרחישי בדיקה

### 1. אימות שדות חובה (Validation)

הבדיקה מוודאת שלא ניתן ליצור משימת איסוף רכב ללא מילוי כל שדות החובה הנדרשים.
הסדר שנבדק:

1.  **טלפון**: המערכת דורשת טלפון אם לא נבחר לקוח קיים (או אם הלקוח החדש טרם נוצר).
2.  **לקוח**: חובה לבחור לקוח מתוך הרשימה או ליצור לקוח חדש.
3.  **רכב לקוח**: עבור משימה זו, חובה לשייך רכב של הלקוח (לא רכב סוכנות).
4.  **כתובת**: חובה להזין כתובת לאיסוף.
5.  **יועץ**: חובה להזין שם יועץ או לבחור צבע יועץ.

**תוצאה:** הבדיקה עוברת בהצלחה - הדיאלוג מציג הודעות שגיאה (`toastError`) מתאימות בכל שלב עד למילוי כל הפרטים.

### 2. יצירת משימה עם לקוח ורכב קיימים

נבדק תרחיש בו המשתמש בוחר לקוח מתוך רשימת הלקוחות הקיימת ובוחר רכב לקוח שכבר משויך אליו.

- בחירת לקוח באמצעות חיפוש והקלדה.
- בחירת רכב לקוח מתוך הצעות החיפוש.
- מילוי שאר השדות (כתובת, יועץ).
- שליחת הטופס.

**תוצאה:** הבדיקה עוברת בהצלחה - נשלחת בקשת POST ל-`/api/admin/tasks` עם הנתונים הנכונים.

### 3. יצירת משימה עם לקוח חדש ורכב חדש

נבדק תרחיש מלא של "משתמש חדש" במערכת:

1.  פתיחת טופס "לקוח חדש" ומילוי פרטיו.
2.  שמירת הלקוח (וידוא קריאת API ל-`/api/admin/clients`).
3.  פתיחת טופס "רכב חדש" עבור אותו לקוח.
4.  שמירת הרכב (וידוא קריאת API ל-`/api/admin/clients-vehicles`).
5.  מילוי כתובת ופרטי יועץ.
6.  יצירת המשימה.

**תוצאה:** הבדיקה עוברת בהצלחה - כל שלבי היצירה מטופלים כראוי והמשימה נוצרת בסיום.

## טכנולוגיות ושימוש ב-Mocks

- **Jest & React Testing Library**: להרצת הבדיקות ודימוי אינטראקציית משתמש.
- **Mock Fetch**: דימוי של שרתי ה-API (לקוחות, רכבים, משימות) כדי לבדוק את הלוגיקה בצד הלקוח בלבד.
- **Mock Toast**: וידוא הצגת הודעות שגיאה והצלחה למשתמש.

---

_נוצר באופן אוטומטי על ידי ה-AI_
